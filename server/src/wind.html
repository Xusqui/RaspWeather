<html>
<head>
<title>IP Anemometer</title>
<link rel="stylesheet" type="text/css" href="ipa.css" />
<script type="text/javascript" src="ipa.js"></script>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load('visualization', '1.0', {'packages':['corechart']});
google.setOnLoadCallback(onLoadHandler);

// Callback that creates and populates a data table,
// instantiates the pie chart, passes in the data and
// draws it.
function onLoadHandler() {
  var stats = ipa.requestStats(document.getElementById('ipaMinutes').value);  // XXX

  // Create the data table.
  var data = new google.visualization.DataTable();
  data.addColumn('datetime', 't');
  data.addColumn('number', 'avg');
  data.addColumn('number', 'max');
  // data.addRows(stats[6]);
  var timeSeries = stats[6];
  for (var i = 0; i < timeSeries.length; ++i) {
    var row = timeSeries[i];
    row[0] = new Date(row[0]);
    data.addRow(row);
  }
  var options = {
    title: 'Wind [km/h]',
    hAxis: { format: 'HH:mm:ss' },
    legend: { position: 'bottom' }
  };
  // Instantiate and draw our chart, passing in some options.
  var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
  chart.draw(data, options);

}
</script>

</head>
<body>
<div id="ipaWind">loading...</div>
Minutes:
<input id="ipaMinutes" type="text" maxlength="4" size="4" onkeyup="onLoadHandler()" value="3" />
<hr />

<div id="chart_div" style="width:400; height:300"></div>

</body>
</html>
